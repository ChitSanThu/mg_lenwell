webpackJsonp([6],{"1CZq":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Js1K"),n=a("BO1k"),o=a.n(n),r={name:"adminEdit",props:["roleId"],data:function(){return{lang:this.$i18n.locale,list:[],fileList:[],repair_process:[],repair_process_id:[],adminForm:{id:"",account:"",nickname:"",avatar:"",mobile:"",email:"",role_id:"",password:"",repair_process:"",status:"1",form_token:""},rules:{account:[{required:!0,message:this.$t("config.account_no"),trigger:"blur|change"}],nickname:[{required:!0,message:this.$t("config.nickname_no"),trigger:"blur|change"}],avatar:[{required:!0,message:this.$t("config.avatar_no"),trigger:"blur|change"}],mobile:[{required:!0,message:this.$t("config.mobile_no"),trigger:"blur|change"}],email:[{required:!0,message:this.$t("config.email_no"),trigger:"blur|change"},{pattern:"^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(.[a-zA-Z0-9_-]+)+$",message:this.$t("config.email_no_error"),trigger:"blur|change"}],role_id:[{required:!0,message:this.$t("admin.role_no"),trigger:"change"}],password:[{required:!0,message:this.$t("config.password_no"),trigger:"blur|change"}],repair_process:[{required:!0,message:this.$t("admin.repair_process_no"),trigger:"blur|change"}]}}},computed:{uploadAction:function(){return this.$store.state.uploadAction}},created:function(){this.getRoleList(),this.roleId&&(this.getAdminInfo(this.roleId),this.rules.password={required:!1,message:this.$t("config.password_no"),trigger:"blur|change"}),this.getformtoken(),this.getProcessList()},methods:{getProcessList:function(){var e=this;e.$request.getProcessList().then(function(t){1==t.code&&(e.repair_process=t.data.list)})},bindProcessChange:function(){this.adminForm.repair_process=this.repair_process_id.join(","),console.log(this.repair_process_id.join(","))},getAdminInfo:function(e){var t=this;t.$request.getAdminInfo({id:e}).then(function(e){if(1==e.code&&e.data)for(var a in t.fileList.push({url:e.data.full_avatar}),e.data){if("status"==a&&(e.data[a]=String(e.data[a])),"repair_process"==a){var i=e.data[a].split(",");for(var n in i)i[n]&&(t.repair_process_id[n]=Number(i[n]))}for(var o in t.adminForm)o==a&&(t.adminForm[o]=e.data[a])}})},getRoleList:function(){var e=this,t=[];e.$request.getRolesList().then(function(a){if(a.data){var i=!0,n=!1,r=void 0;try{for(var s,l=o()(a.data);!(i=(s=l.next()).done);i=!0){var c=s.value;"ch"==e.$i18n.locale?t.push({id:c.id,name:c.title_zh}):t.push({id:c.id,name:c.title})}}catch(e){n=!0,r=e}finally{try{!i&&l.return&&l.return()}finally{if(n)throw r}}}e.list=t})},fileUpload:function(e){var t=this;e.status="uploading";var a=new FormData;a.append("file",e.file),t.$request.fileUpload(a).then(function(a){1==a.code?(e.status="done",t.adminForm.avatar=a.data.url):e.status="failed"})},getformtoken:function(){var e=this;e.$request.getformtoken().then(function(t){e.adminForm.form_token=t.data.token})},submitForm:function(e){var t=this,a=this;a.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;a.$request.setAdminSave(a.adminForm).then(function(e){1==e.code?(a.$emit("changeAdminDialog",a.adminForm),t.$notify({title:a.$t("config.tips"),message:e.msg,type:"success",duration:"2000"})):a.getformtoken()})})}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"rule_edit",staticStyle:{"padding-top":"30px"}},[a("el-form",{ref:"adminForm",staticClass:"demo-adminForm",attrs:{model:e.adminForm,rules:e.rules,"status-icon":"","label-width":"120px"}},[a("el-form-item",{staticClass:"upload-form-item",attrs:{label:e.$t("config.avatar")}},[a("van-uploader",{attrs:{"preview-size":"100px","preview-full-image":!1,"after-read":e.fileUpload,"max-count":1},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("admin.role"),prop:"role_id"}},[a("el-select",{attrs:{placeholder:e.$t("config.select")},model:{value:e.adminForm.role_id,callback:function(t){e.$set(e.adminForm,"role_id",t)},expression:"adminForm.role_id"}},e._l(e.list,function(t,i){return e.list?a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}}):e._e()}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("config.account"),prop:"account"}},[a("el-input",{model:{value:e.adminForm.account,callback:function(t){e.$set(e.adminForm,"account",t)},expression:"adminForm.account"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("config.nickname"),prop:"nickname"}},[a("el-input",{model:{value:e.adminForm.nickname,callback:function(t){e.$set(e.adminForm,"nickname",t)},expression:"adminForm.nickname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("config.mobile"),prop:"mobile"}},[a("el-input",{model:{value:e.adminForm.mobile,callback:function(t){e.$set(e.adminForm,"mobile",t)},expression:"adminForm.mobile"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("config.email"),prop:"email"}},[a("el-input",{model:{value:e.adminForm.email,callback:function(t){e.$set(e.adminForm,"email",t)},expression:"adminForm.email"}})],1),e._v(" "),3==e.adminForm.role_id?a("el-form-item",{attrs:{label:e.$t("admin.repair_process"),prop:"repair_process"}},[a("el-select",{attrs:{multiple:"",placeholder:e.$t("config.select")},on:{change:e.bindProcessChange},model:{value:e.repair_process_id,callback:function(t){e.repair_process_id=t},expression:"repair_process_id"}},e._l(e.repair_process,function(t,i){return e.repair_process?a("el-option",{key:t.id,attrs:{label:"ch"==e.lang?t.title_zh:t.title,value:t.id}}):e._e()}),1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:e.$t("config.status")}},[a("el-radio",{attrs:{label:"1"},model:{value:e.adminForm.status,callback:function(t){e.$set(e.adminForm,"status",t)},expression:"adminForm.status"}},[e._v(e._s(e.$t("config.start_using")))]),e._v(" "),a("el-radio",{attrs:{label:"2"},model:{value:e.adminForm.status,callback:function(t){e.$set(e.adminForm,"status",t)},expression:"adminForm.status"}},[e._v(e._s(e.$t("config.deactivate")))])],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("config.password"),prop:"password"}},[a("el-input",{attrs:{type:"password",autocomplete:"new-password",placeholder:"Eidtï¼šplease leave blank if you do not want to change your password"},model:{value:e.adminForm.password,callback:function(t){e.$set(e.adminForm,"password",t)},expression:"adminForm.password"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("adminForm")}}},[e._v(e._s(e.$t("config.submit")))])],1)],1)],1)},staticRenderFns:[]};var l=a("VU/8")(r,s,!1,function(e){a("YFQ8")},"data-v-21378fd0",null).exports,c={components:{layoutPage:i.a,adminEdit:l},data:function(){return{tableLoding:!0,searchShow:!1,dialogTableVisible:!1,dialogTableTitle:"",roleId:null,search:{page:1,pagesize:15,account:"",id:"",nickname:"",email:""},total:0,tableheight:"100%",tableData:[]}},computed:{rank:function(){return this.$store.state.rank}},created:function(){this.getList()},methods:{refresh:function(){this.getList()},searchTableList:function(e){this.search.page=1,this.getList()},resetForm:function(){var e=this.search;for(var t in e)e[t]="page"==t?1:"";console.log(e),this.search=e,this.getList()},changPageSize:function(e){this.search.pagesize=e,this.getList()},changCurrentPage:function(e){this.search.page=e,this.getList()},changJumpPage:function(e){this.search.page=e,this.getList()},bindSearch:function(){var e=this;e.searchShow?e.searchShow=!1:(e.searchShow=!0,setTimeout(function(){e.searchHeight=e.$refs.ruleForm.$el.offsetHeight},100))},getList:function(){var e=this;e.tableLoding=!0,e.$request.getAdminList(e.search).then(function(t){e.tableLoding=!1,e.tableData=t.data.list,e.total=t.data.total})},addRow:function(){this.dialogTableTitle="Add Info",this.dialogTableVisible=!0,this.roleId=""},EditRow:function(e){this.dialogTableTitle="Edit Info",this.dialogTableVisible=!0,this.roleId=e.id},changeAdminDialog:function(e){this.dialogTableVisible=!1,this.getList()},deleteRow:function(e){var t=this,a=this;a.$alert(a.$t("config.delMsg"),a.$t("config.tips"),{confirmButtonText:a.$t("config.confirm"),showCancelButton:!0,cancelButtonText:a.$t("config.cancel")}).then(function(){a.$request.delAdmin({id:e.id}).then(function(e){a.getList(),t.$notify({title:a.$t("config.tips"),message:e.data.msg,type:"success"})})})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"admin-body",staticStyle:{"background-color":"white","border-radius":"5px",padding:"15px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.searchShow,expression:"searchShow"}],staticClass:"toolbar_form"},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.search,"label-width":"80px"}},[a("el-form-item",{attrs:{label:e.$t("config.account")}},[a("el-input",{model:{value:e.search.account,callback:function(t){e.$set(e.search,"account",t)},expression:"search.account"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("config.nickname")}},[a("el-input",{model:{value:e.search.nickname,callback:function(t){e.$set(e.search,"nickname",t)},expression:"search.nickname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"ID"}},[a("el-input",{model:{value:e.search.id,callback:function(t){e.$set(e.search,"id",t)},expression:"search.id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("config.email")}},[a("el-input",{model:{value:e.search.email,callback:function(t){e.$set(e.search,"email",t)},expression:"search.email"}})],1),e._v(" "),a("el-form-item",[a("el-button",{staticClass:"d-buttom",attrs:{type:"primary"},on:{click:function(t){return e.searchTableList("ruleForm")}}},[e._v(e._s(e.$t("config.search")))]),e._v(" "),a("el-button",{staticClass:"d-buttom",on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v(e._s(e.$t("config.reset")))])],1)],1)],1),e._v(" "),a("div",{staticClass:"toolbar"},[a("div",{staticClass:"toolbar_left"},[a("el-button",{staticClass:"d-refresh-button",attrs:{icon:"el-icon-refresh"},on:{click:function(t){return e.refresh()}}}),e._v(" "),e.rank&&e.rank.add?a("el-button",{staticClass:"d-buttom",attrs:{type:"success",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v(e._s(e.$t("config.add")))]):e._e()],1),e._v(" "),a("div",{staticClass:"toolbar-form"},[a("el-button",{staticClass:"d-buttom",attrs:{type:"info",icon:"el-icon-search"},on:{click:e.bindSearch}})],1)]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoding,expression:"tableLoding"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"max-height":e.tableheight,stripe:""}},[a("el-table-column",{attrs:{fixed:"",prop:"id",label:"ID",width:"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"avatar",width:"120",label:e.$t("config.avatar")},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e.row.full_avatar,fit:"contain",lazy:""}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"account","min-width":"200",label:e.$t("config.account")}}),e._v(" "),a("el-table-column",{attrs:{prop:"nickname","min-width":"200",label:e.$t("config.nickname")}}),e._v(" "),a("el-table-column",{attrs:{prop:"email","min-width":"200",label:e.$t("config.email")}}),e._v(" "),a("el-table-column",{attrs:{prop:"mobile","min-width":"200",label:e.$t("config.mobile")}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:e.$t("config.status"),width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:1==t.row.status?"primary":"success","disable-transitions":""}},[e._v(e._s(1==t.row.status?e.$t("config.start_using"):e.$t("config.deactivate")))])]}}])}),e._v(" "),e._v('")"\n       width="180">\n    '),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:e.$t("config.operate"),width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.rank&&e.rank.edit?a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.EditRow(t.row)}}},[e._v("\n          "+e._s(e.$t("config.edit"))+"\n        ")]):e._e(),e._v(" "),e.rank&&e.rank.del?a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.deleteRow(t.row)}}},[e._v("\n          "+e._s(e.$t("config.del"))+"\n        ")]):e._e()]}}])})],1),e._v(" "),a("layoutPage",{attrs:{total:e.total,currentpage:e.search.page},on:{changPageSize:e.changPageSize,changCurrentPage:e.changCurrentPage,changJumpPage:e.changJumpPage}}),e._v(" "),e.dialogTableVisible?a("el-dialog",{attrs:{visible:e.dialogTableVisible,width:"800px",title:e.dialogTableTitle},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("adminEdit",{attrs:{roleId:e.roleId},on:{changeAdminDialog:e.changeAdminDialog}})],1):e._e()],1)},staticRenderFns:[]};var u=a("VU/8")(c,d,!1,function(e){a("KNvK")},"data-v-3736e225",null);t.default=u.exports},BO1k:function(e,t,a){e.exports={default:a("fxRn"),__esModule:!0}},KNvK:function(e,t){},YFQ8:function(e,t){},fxRn:function(e,t,a){a("+tPU"),a("zQR9"),e.exports=a("g8Ux")},g8Ux:function(e,t,a){var i=a("77Pl"),n=a("3fs2");e.exports=a("FeBl").getIterator=function(e){var t=n(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return i(t.call(e))}}});